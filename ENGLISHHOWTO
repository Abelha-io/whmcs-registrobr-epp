Copy the modules tree from the distribution files to the WHMCS folder. 
See CONFIG for configuration instructions.

Please see https://github.com/registrobr/whmcs-registrobr-epp/ for further information.

Portuguese language support from the community might be obtained at one of these forums:
- https://eng.registro.br/mailman/listinfo/eppnicbr
- http://www.webhostingtalk.com.br/
- http://portaldohost.com.br/forum/


DETAILS

- WHMCS version 4.x or higher (sync requires version 5.1 or higher)
- All WHMCS's dependencies WHMCS such as Apache, MySQL etc..
- POSIX Enviroment (Linux, FreeBSD and other meet this requirement)
- PHP version 5.1 or higher
- SSL Support
- Support for sockets (according to this requirement and the security environment not shared SSL certificate is recommended)
- Permission to firewall UDP ports 43 and 700 on TCP servers beta.registro.br, and registro.br epp.registro.br
- Correct time on server (NTP recommended but not required)
- Superuser access (root)

INSTALLATION

1 - Login as root or use sudo or su
2 - Run the install.sh with the following parameters:
install.sh <whmcsdir> <crontabfile> <whmcswebdomain>

If not specified, the default value of whmcsdir default is "/var/www/whmcs" to crontabfile "/var/spool/cron /crontabs/root" and the hostname of the machine to whmcswebdomain.

2 - After the script, the following should occur:

a) The files Avail.php brdomaincheck.php and should be in the server's root directory 
b) The file must have whmcs whoisserver.php of entries. br modified with the content of listservers.txt, pointing to your domain.
c) ... whmcs/modules/registrars/registrobr/  should be created and contain the distribution files
d) At the root crontab should contain the following entry:

17 * * * * /dir_whmcs/modules/registrars/registrobr/registrobrpoll.php > /dev/null 2> & 1

This entry will be responsible for obtaining any return messages on transactions and registrations.

SETTING

1) In WHMCS's control panel, click on "Setup" => "General Settings".

2) In the left column, click on "Products / Services" => "Domain Registrars"

3) Enable Registro.br module and then configure it.

4) Fill the blanks with your data authentication. Username is the number of EPP provider (ex: 001) and not the ID provider (eg ANF).
   For now, leaves the TestMode option enabled. The certificate for use of beta.registro.br comes as part of the distribution module.

5) CPF and CNPJ are the indications of which fields from the database of clients are being used to store this information. They may be the same field or different fields.

6) Filling TechC is optional; without him domains are created with equal technical contact the registrant.

7) For the correct processing of the messages return ("Poll"), you need support departments in WHMCS and assign users to them. In the "Sender Username", use a Username that is on your list of administrators ('../Whmcs/admin/configadmins.php') as root, or sign one.
 
8) Suggest, though not required, keep enable the module log in Utilities -> Log -> Log Module, even for production use, to facilitate the diagnosis of
problems reported by customers. Thus, it isn't necessary to ask the customer to redo a transaction to be diagnosed with a problem.

TESTS

1) Enable the module in Utilities Logs -> Log -> Log Module
2) Confirm that the option is enabled in TestMode "Domain Registrars"
3) On your DNS server, create an entry for a domain that does not yet exist.
4) Set up your test replacing "yourdomain" with the domain where you had installed the WHMCS

   

   The parameters:
   a) case: options => 'case1', 'case2', 'case3', 'case4'
   b) domain: the domain to be registered, eg example.com.br
   c) debug: will present test results on the screen for more detailed results you should see "Log Module" debug.
   d) TESTMODE: 0 or 1
   e) ns1: name NAMESERVER1 (input your domain must already exist)
   f) ns2: name NAMESERVER2 (input your domain must already exist)
   
 5) Start the test by 'case1' option, the domain will be register  (remember that DNS entries must exist)
    
    Wait a few minutes (no less than 15 minutes) and verify if the  domain was registered correctly on the server beta.registor.br (test) using:
    
    whois-h beta.registro.br example.com.br

    Log http://yourdomain/whmcs/admin/systemmodulelog.php and check the outputs of the test. If it was properly registered, go to case2.
    
    
 6) Case 2:
 
 After completing the Case 1 and have the domain registered without the occurrence of tickets, test Case2:
 
 
This test will verify that these functions are working:

a) Request and Assignment of Domain's Nameservers
b) Request and Assignment of Domain's contacts.
c) Role of Synchronization with the information registro.br
d) Role of exchanging messages with registro.br

Log http://yourdomain/whmcs/admin/systemmodulelog.php and check the outputs of the test.
    
    
7) Case 3:

After completing the second case, test case 3:

The test will perform the removal of the servers in the domain of test registro.br

 Log http://yourdomain/whmcs/admin/systemmodulelog.php and check the outputs of the test.
 
 Check with "whois-hbeta.registro.br yourdomain" and make sure the domain was removed.
 
 
 8) Case 4:
 
 Perform again the case 1 (re-registering the domain) and make sure the data is correct through "whois-hbeta.registro.br yourdomain".
 
 The test will perform the renovation of the field into the test servers registro.br
 
 Log http://yourdomain/whmcs/admin/systemmodulelog.php and check the outputs of the test.
 
 Perform "whois-h beta.registro.br yourdomain" and make sure the domain was actually new (check the field "Expires").
  
 
ACTIVATION IN PRODUCTION

- Copy the  receveid file .pem  for an area outside of Apache's documents directory
- In the administration of WHMCS -> Setup -> General Settings -> Domain Registrars -> Registro.br, disable the option TESTMODE, change user and password information for the production and enter the directory where the certificate was copied and the pass-phrase certified
- Make a test recording without DNS records to verify that a ticket can be generated. Don't configure DNS for domain TO AVOID THE TRANSACTION !

